<div class="grid">
  <div class="col-12">
    <div class="card">
      <div class="page-header">
        <h5>{{'USERS_MANAGER.masterData'|translate}}</h5>
        <p-button [label]="'USERS_MANAGER.newUser'|translate" icon="pi pi-user-plus" styleClass="p-button-danger" (click)="goToNewUser()"
          class="ms-start"></p-button>
      </div>
      <p-table #dt [value]="(users|async) ?? []" [rowHover]="true" [responsive]="true" [scrollable]="false" [paginator]="true"
        [rows]="5" [rowsPerPageOptions]="[5,10,20]" selectionMode="single" dataKey="id" styleClass="p-datatable-striped"
        responsiveLayout="scroll" (onRowSelect)="goToEditUser($event)">
        <ng-template pTemplate="header">
          <tr>
            <th>#</th>
            <th pSortableColumn="username">{{'USERS_MANAGER.username'|translate}}</th>
            <th pSortableColumn="name">{{'USERS_MANAGER.name'|translate}} <p-sortIcon field="name"></p-sortIcon></th>
            <th pSortableColumn="surname">{{'USERS_MANAGER.surname'|translate}} <p-sortIcon field="surname"></p-sortIcon></th>
            <th pSortableColumn="email">Email <p-sortIcon field="email"></p-sortIcon></th>
            <th pSortableColumn="role">{{'USERS_MANAGER.role'|translate}} <p-sortIcon field="role"></p-sortIcon></th>
            <th pSortableColumn="status">Status <p-sortIcon field="status"></p-sortIcon></th>
            <th class="text-center">{{'USERS_MANAGER.details'|translate}}</th>
            <th class="text-center">{{'USERS_MANAGER.delete'|translate}}</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-user columns="col" let-i="rowIndex">
          <tr [pSelectableRow]="user">
            <td>{{ i+1 }}</td>
            <td>{{user.username}}</td>
            <td>{{ user.name }}</td>
            <td>{{ user.surname }}</td>
            <td><a href="mailto:{{ user.email }}">{{ user.email }}</a></td>
            <td>{{ user.role }}</td>
            <td>{{ user.active ? 'ACTIVE' : 'INACTIVE' }}</td>
            <td class="text-center">
              <button pButton pRipple type="button" icon="pi pi-user-edit" aria-label="Go to edit user"
                class="p-button-rounded p-button-danger p-button-text" (click)="goToEditUserById(user.id)">
              </button>
            </td>
            <td class="text-center">
              <button pButton pRipple type="button" icon="pi pi-user-minus" aria-label="Remove user"
                class="p-button-rounded p-button-danger p-button-text" (click)="onRemoveUser(user.username, user.id)">
              </button>
            </td>
          </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="7">{{'USERS_MANAGER.emptyUsers'|translate}}</td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>
</div>
<app-popup-delete-item #popupDeleteItem></app-popup-delete-item>