<div class="toolbar">

</div>

<div class="form-group row mx-0 px-0 justify-content-center">
  <label class="col-sm-2 col-form-label">Layer</label>
  <div class="col-sm-6">
    <div class="p-fluid">
      <p-dropdown #layer="ngModel" name="layer" appendTo="body" [(ngModel)]="selectedLayer"
        placeholder="Seleziona un layer" [options]="layerOptions" [filter]="true" [showClear]="true" (onChange)="changeLayer($event)" [required]="true">
      </p-dropdown>
      <div *ngIf="layer.invalid && (layer.touched || layer.dirty)" class="invalid-feedback">
        <div *ngIf="layer.errors?.['required']">
          Seleziona un layer
        </div>
      </div>
    </div>
  </div>
</div>

<div class="row mx-0">
  <div class="col-8" >
    <div class="text-container" [ngStyle]="{'height.px': textContainerHeight}">
      <div id="svg" [ngStyle]="{'height.px': svgHeight}" #svg>
        <svg class="text-editor" [attr.height]="svgHeight">
          <defs>

          </defs>
          <g class="background">
            <rect *ngFor="let row of rows; index as i" [ngClass]="{'background0': i%2, 'background1 bordered': !(i%2)}" [attr.height]="row.height" [attr.y]="row.yBG"></rect>
          </g>
          <g class="glow">

          </g>
          <g class="highlight">

          </g>
          <g class="text">
            <!-- <text height="16">
              <tspan>
                ciao
              </tspan>
            </text> -->
            <text *ngFor="let row of rows; index as i" [attr.y]="row.yText" [attr.x]="37" [attr.height]="row.height" (mouseup)="selectionchange($event)" style="white-space: pre;">
              <tspan *ngFor="let line of row.lines;" [attr.y]="line.yText" [attr.x]="37" [attr.height]="line.height" style="white-space: pre;">
                <tspan *ngFor="let w of line.words" [attr.y]="line.yText" style="white-space: pre;">{{w}}</tspan>
              </tspan>
            </text>
            <!-- <text *ngFor="let row of rows; index as i" [attr.y]="row.yText" [attr.x]="37" [attr.height]="row.height" (mouseup)="selectionchange($event)">{{row.text}}</text> -->
          </g>
          <!-- Generare n gruppi per archi e annotazioni -->
          <g>

          </g>
          <!-- -->
          <g class="sentnum unselectable">
            <text *ngFor="let row of rows; index as i" [attr.y]="row.ySentnum" [attr.x]="32" [attr.height]="row.height">
              {{i+1}}
            </text>
            <path [attr.d]="dVerticalLine"></path>
          </g>
        </svg>
      </div>
    </div>
  </div>
  <div class="col-4 ps-0">
    <div class="text-container" [ngStyle]="{'height.px': textContainerHeight}">
      <app-annotation-editor [annotationModel]="annotation"></app-annotation-editor>
    </div>
  </div>
</div>
