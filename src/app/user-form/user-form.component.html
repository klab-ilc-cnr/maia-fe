<div class="grid">
  <div class="col-12">
    <div class="card">
      <div class="page-header">
        <h5>
          <div *ngIf="isEditUser(); else elseBlock">Dettaglio utente</div>
          <ng-template #elseBlock>Nuovo utente</ng-template>
        </h5>
      </div>
      <div class="card-body p-fluid">
        <form (ngSubmit)="onSubmit()" #userForm="ngForm">
          <div class="form-group">
            <label for="name">Nome *</label>
            <input
              type="text"
              [(ngModel)]="user.name"
              class="form-control"
              id="name"
              name="name"
              placeholder="Inserisci il tuo nome"
              required
              #name="ngModel"
              [disabled]="!canManageUsers"
            />
            <div
              *ngIf="name.invalid && (name.dirty || name.touched)"
              class="alert alert-danger"
            >
              Il nome è obbligatorio
            </div>
          </div>
          <div class="form-group">
            <label for="surname">Cognome *</label>
            <input
              type="text"
              [(ngModel)]="user.surname"
              class="form-control"
              id="surname"
              name="surname"
              placeholder="Inserisci il tuo cognome"
              required
              #surname="ngModel"
              [disabled]="!canManageUsers"
            />
            <div
              *ngIf="surname.invalid && (surname.dirty || surname.touched)"
              class="alert alert-danger"
            >
              Il cognome è obbligatorio
            </div>
          </div>
          <div class="form-group">
            <label for="email">Email *</label>
            <input
              type="email"
              [(ngModel)]="user.email"
              class="form-control disabled"
              id="email"
              name="email"
              placeholder="Inserisci il tuo indirizzo email"
              required
              #email="ngModel"
              [disabled]="isEditUser()"
            />
            <div
              *ngIf="email.invalid && (email.dirty || email.touched)"
              class="alert alert-danger"
            >
              L'email è obbligatoria
            </div>
          </div>
          <div class="form-group">
            <label for="role">Ruolo *</label>
            <p-dropdown
              #role="ngModel"
              name="role"
              [(ngModel)]="user.role"
              [options]="roles"
              [filter]="true"
              [showClear]="true"
              placeholder="Scegli un ruolo"
              [required]="true"
              [disabled]="!roles || !canManageUsers"
            >
            </p-dropdown>
            <div *ngIf="role.invalid && (role.dirty || role.touched)" class="alert alert-danger">
              Il ruolo è obbligatorio
            </div>
          </div>
          <div class="form-group d-flex align-items-center">
            <label for="active">Utente attivo</label>
            <p-inputSwitch
              #active="ngModel"
              name="active"
              [(ngModel)]="user.active"
              [disabled]="!canManageUsers"
            ></p-inputSwitch>
          </div>
          <div class="text-end">
            <button
              type="button"
              (click)="goToUserList()"
              class="btn btn-secondary ms-auto"
              [hidden]="!canManageUsers"
            >
              Annulla
            </button>
            <button
              type="submit"
              [disabled]="!userForm.form.valid"
              [hidden]="!canManageUsers"
              class="btn btn-danger ms-2">
              Salva
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
